<!doctype html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Memory Game</title>

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<link rel="stylesheet" href="css/quizymemorygame.css">
<link rel="stylesheet" href="css/style.css">
<style>
button.commoncss3button{
    width:306px;
	margin-top:10px;
	padding: 5px;
	font-size: 100%;
}
</style>
</head>
<body>
<div id="debug"></div>
<div class="title-holder">
	<a href="index.html">
		<button type="button" name="" value="" class="backcss3button">
			<img src="img/home_icon.png" />
		</button>
	</a>
	<div class="title">
		Settings
	</div>
	<div class="score-holder"></div>
</div>
<div id="main">
	<div class="content-holder">
		<div class="content-title">Sound Effects</div>
		<div class="content-description">
			<div class="onoffswitch">
				<input type="checkbox" class="onoffswitch-checkbox" id="sound_effects" checked onClick="editConfig('sound_effects');" />
				<label class="onoffswitch-label" for="sound_effects">
					<div class="onoffswitch-inner"></div>
					<div class="onoffswitch-switch"></div>
				</label>
			</div> 
		</div> 
	</div>
	<div class="content-holder">
		<div class="content-title">Music Tracks</div>
		<div class="content-description">
			<div class="onoffswitch">
				<input type="checkbox" class="onoffswitch-checkbox" id="music_tracks" checked onClick="editConfig('music_tracks');" />
				<label class="onoffswitch-label" for="music_tracks">
					<div class="onoffswitch-inner"></div>
					<div class="onoffswitch-switch"></div>
				</label>
			</div> 
		</div> 
	</div>
	<a href="how-to-play.html">
		<button type="button" name="" value="" class="commoncss3button">How To Play</button>
	</a>
</div>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/jquery-1.7.1.min.js"><\/script>')</script>
<script src="js/jquery-ui-1.8.17.custom.min.js"></script>

<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript" charset="utf-8">
// Wait for device API libraries to load
document.addEventListener("deviceready", onDeviceReady, false);

// device APIs are available
function onDeviceReady()
{
	var db = window.openDatabase('memory_game_centre', '1.0', 'Memory Game Local Storage', 200000);
	successCB();
}

// Query the database
function queryDB(tx)
{
	tx.executeSql('SELECT * FROM config WHERE 1', [], querySuccess, errorCB);
}

// Query the success callback
function querySuccess(tx, results)
{
	var resultCount = results.rows.length;
	var strRows = '';
	for (var i = 0; i < resultCount; i++)
	{
		strRows += '<tr>' +
			'<td align="center">' + (i + 1) + '</td>' +
			'<td>' + results.rows.item(i).config_key + '</td>' +
			'<td align="center">' + results.rows.item(i).config_value + '</td>' +
		'</tr>';
		
		if(results.rows.item(i).config_value == 'on')
		{
			$('#' + results.rows.item(i).config_key).attr('checked', 'checked');
		}
		else
		{
			$('#' + results.rows.item(i).config_key).removeAttr('checked');
		}
	}
	
	$('#debug').html(strRows);
}

// Transaction error callback
function errorCB(err)
{
	$('#debug').html('Local Database Connection Success');
}

// Transaction success callback
function successCB()
{
	var db = window.openDatabase('memory_game_centre', '1.0', 'Memory Game Local Storage', 200000);
	db.transaction(queryDB, errorCB);
	//$('#debug').html('Local Database Connection Success');
}

function editConfig(id)
{
	var db = window.openDatabase('memory_game_centre', '1.0', 'Memory Game Local Storage', 200000);
	if(id == 'sound_effects')
	{
		db.transaction(updateConfigSound, errorCB, successCB);
	}
	else
	{
		db.transaction(updateConfigMusic, errorCB, successCB);
	}
}

function updateConfigSound(tx)
{
	var configValue = 'off';
	if($('#sound_effects').prop('checked'))
	{
		configValue = 'on';
	}

	tx.executeSql('UPDATE config SET config_value = "' + configValue + '" WHERE config_key = "sound_effects"');
}

function updateConfigMusic(tx)
{
	var configValue = 'off';
	if($('#music_tracks').prop('checked'))
	{
		configValue = 'on';
	}
	alert('taz' + configValue);

	tx.executeSql('UPDATE config SET config_value = "' + configValue + '" WHERE config_key = "music_tracks"');
}
</script>
</body>
</html>